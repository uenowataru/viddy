var moved = false;
var arrowtimeout;
var titletimeout;
var timebartimeout;

$(document).ready(function(){
  $( "#body" ).animate({
    backgroundColor: "#000000",
  },2000);

  setTimeout(function(){
    $( "#arrowL" ).animate({
      opacity: 0
    },2000);
    $( "#arrowR" ).animate({
      opacity: 0
    },2000);
    moved = false;
  }, 4000);

  window.onmousemove = function(e){
    $( "#timebar" ).width(getVideoProgress()+'%');
    
    if(!moved){
      loadTitle();
      animateTitle();
      animateArrow();
      animateTimeBar();
      moved = true;
    }else{
      clearTimeout(arrowtimeout);
      clearTimeout(titletimeout);
      clearTimeout(timebartimeout);
      arrowtimeout = setTimeout(function(){
        $( "#arrowL" ).animate({
          opacity: 0
        },1000);
        $( "#arrowR" ).animate({
          opacity: 0
        },1000);
        moved = false;
      }, 2000);
      titletimeout = setTimeout(function(){
        $( "#title" ).animate({
          opacity: 0
        },1000);
      }, 2000);
      timebartimeout = setTimeout(function(){
        $( "#timebar" ).animate({
          opacity: 0
        },{
          step: function( now, fx ) {
            $( "#timebar" ).width(getVideoProgress()+'%');
          }
        }, 1000
        );
      }, 2000);
    }
  };
});



$(document.activeElement).keydown(function(e) {
  if(!initialized) return;
  if(e.which== 37){
    previousVideo();
    animateTitle();
  } //left
  
  if(e.which== 39){
    nextVideo();
    animateTitle();
  } // right
  if(e.which== 38){
    animateTimeBar();
    skipVideoTo(-1);
  } //up
  if(e.which== 40){
    animateTimeBar();
    skipVideoTo(-2);
  } //down
  if(e.which >= 48 && e.which <= 57){
    animateTimeBar();
    skipVideoTo(e.which - 48);
  }
  e.preventDefault(); // prevent the default action (scroll / move caret)
});


function mouseMove(){

}



function mouseClick(){
  togglePlayPause();
}

function arrowLeftClick(){
  previousVideo();
  animateTitle();
}
function arrowRightClick(){
  nextVideo();
  animateTitle();
}

function titleClick(){
  if(!initialized) return;
  pauseVideo();
  window.open("https://www.youtube.com/watch?v=" + queue[currindex][0]);
}

function loadTitle(){
  if(!initialized) return;
  var vidtitle = queue[currindex][1];
  $( "#title" ).text(vidtitle);
}

function animateTitle(){
  clearTimeout(titletimeout);
  $( "#title" ).animate({
    opacity: 0.75,
  },500);
  clearTimeout(titletimeout);
  titletimeout = setTimeout(function(){
    $( "#title" ).animate({
      opacity: 0
    },1000);
  }, 2000);

}

function animateArrow(){
  $( "#arrowL" ).animate({
    opacity: 0.5
  },500);
  $( "#arrowR" ).animate({
    opacity: 0.5
  },500);
  clearTimeout(arrowtimeout);
  arrowtimeout = setTimeout(function(){
    $( "#arrowL" ).animate({
      opacity: 0
    },1000);
    $( "#arrowR" ).animate({
      opacity: 0
    },1000);
  }, 2000);
}


function animateTimeBar(){
  $( "#timebar" ).animate({
    opacity: 0.5,
  },{
    step: function( now, fx ) {
      $( "#timebar" ).width(getVideoProgress()+'%');
    }
  },500);
  clearTimeout(timebartimeout);
  timebartimeout = setTimeout(function(){
    $( "#timebar" ).animate({
      opacity: 0
    },{
      step: function( now, fx ) {
        $( "#timebar" ).width(getVideoProgress()+'%');
      }
    },1000);
  }, 2000);
}



$('html').on ('mousewheel', function (e) {
    var delta = e.originalEvent.wheelDelta;
    if (delta < 0) {
        $('p').text ('You scrolled down');
    } else if (delta > 0) {
        $('p').text ('You scrolled up');
    }
});




