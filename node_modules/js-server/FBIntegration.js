module.exports = {
  postToFB: function (post) {
    postMessage(post);
  }
};

var request = require("request");
var FB = require('fb');

FB.setAccessToken('CAAXUl7PaI4oBABZB4SZBA3EittZCUqSwRgJDOEeorg7MsJAPjqbUBivgaQsrqOaQ5Mj486AOeWZBBEICIJH9RX1A20NIrZAks9mjyJdYhBBRmOB4dxoMh4rZC9QPUtBtZBgBXxsJcMCopDdHQcA8y1VkWvX4ZBCZBDuZBVA927n3JWOK6WBhD8bZBzUZAveHw4YZBHnZA6GdVZCBs0C5gZDZD');
postMessage('test post!!!\nhttps://www.youtube.com/watch?v=sOnu2zSXPqY');

setInterval(function(){
  try{
    postMessage('feafe');
  }catch(err){
    console.log(err);
  }
}, 15*60*1000);

var count = 0;

function postMessage(post){
    //   var access_token = 'CAAXUl7PaI4oBABZB4SZBA3EittZCUqSwRgJDOEeorg7MsJAPjqbUBivgaQsrqOaQ5Mj486AOeWZBBEICIJH9RX1A20NIrZAks9mjyJdYhBBRmOB4dxoMh4rZC9QPUtBtZBgBXxsJcMCopDdHQcA8y1VkWvX4ZBCZBDuZBVA927n3JWOK6WBhD8bZBzUZAveHw4YZBHnZA6GdVZCBs0C5gZDZD';
    // FB.api('oauth/access_token', {
    //     client_id: '1641122906121098',
    //     client_secret: 'ba3410f9c0afca7b95ca58e3e203f7f6',
    //     grant_type: 'client_credentials'
    // }, function (res) {
    //     if(!res || res.error) {
    //         console.log(!res ? 'error occurred' : res.error);
    //         return;
    //     }

    //     var accessToken = res.access_token;
    //     console.log("access:" + accessToken);
    //     FB.setAccessToken(accessToken);

    //     FB.api('713379078808771', { fields: ['access_token'] }, function (res) {
    //       if(!res || res.error) {
    //        console.log(!res ? 'error occurred' : res.error);
    //        return;
    //       }
    //       console.log(res);
    //       console.log(res.access_token);
    //     });
    // });
  
    var body = 'test' + count++ + 'post' + count + '!!!\nhttps://www.youtube.com/watch?v=sOnu2zSXPqY';
    if(count & 1 == 0) body = 'posting alternate';
    
    FB.api('713379078808771/feed', 'post', { message: body}, function (res) {
      if(!res || res.error) {
        console.log(!res ? 'error occurred' : res.error);
        return;
      }
      console.log('Post Id: ' + res.id);
    });
      console.log('Post tried');
}

// function postMessage(access_token, message) {
//     // Specify the URL and query string parameters needed for the request
//     var url = 'https://graph.facebook.com/713379078808771/feed';
//     var params = {
//         access_token: access_token,
//         message: message
//     };

//   // Send the request
//     request.post({url: url, qs: params}, function(err, resp, body) {
      
//       // Handle any errors that occur
//       if (err) return console.error("Error occured: ", err);
//       body = JSON.parse(body);
//       if (body.error) return console.error("Error returned from facebook: ", body.error);
//     });
// }

//CAAXUl7PaI4oBAIwuUHigEamiWZBV2jBTeXq9QHnoLqdMKJfeykq7jDZC68UK22bQy2fHDQZCsQpTXwv3F1nfXv4VzLwui0LHUyoPIXd7UsGYHfrZCst75YdTIWYAiLh0kTEtuHdOZB8PL97hsypo5wrSda8eY1IQZAsBeWbex1prymrqRsAgk8vfwfVhAQXOAZD